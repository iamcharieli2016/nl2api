2024-12-18 09:45:36,582 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-18 09:45:37,585 - sql2api - INFO - 找到API映射: http://localhost:8080/service/D_A_BSPDDC00_QPC
2024-12-18 09:45:37,586 - sql2api - INFO - 准备调用API: http://localhost:8080/service/D_A_BSPDDC00_QPC
2024-12-18 09:45:37,635 - sql2api - ERROR - API调用失败: 500 Server Error:  for url: http://localhost:8080/service/D_A_BSPDDC00_QPC
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 45, in call_api
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/requests/models.py", line 953, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error:  for url: http://localhost:8080/service/D_A_BSPDDC00_QPC
2024-12-18 09:45:37,636 - sql2api - ERROR - API调用异常: API调用失败: 500 Server Error:  for url: http://localhost:8080/service/D_A_BSPDDC00_QPC
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 45, in call_api
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/requests/models.py", line 953, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error:  for url: http://localhost:8080/service/D_A_BSPDDC00_QPC

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 68, in execute_sql
    result = caller.call_api(
             ^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 53, in call_api
    raise Exception(f"API调用失败: {str(e)}")
Exception: API调用失败: 500 Server Error:  for url: http://localhost:8080/service/D_A_BSPDDC00_QPC
2024-12-24 11:39:19,976 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 11:53:53,032 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:02:17,567 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:16:32,130 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:19:51,971 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:21:26,581 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:42:37,586 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 14:55:53,693 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 15:51:34,199 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 15:53:29,656 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 15:57:47,189 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 15:58:58,180 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:02:06,585 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:02:52,779 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:05:23,552 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:06:35,354 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:14:45,962 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:14:56,166 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:30:39,028 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:31:02,370 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:44:56,122 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:45:32,007 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:49:30,213 - sql2api - ERROR - SQL解析失败: type object 'Token' has no attribute 'Text'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.ttype is not Token.Text.Whitespace and operator is not None:
                          ^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Text'
2024-12-24 16:49:30,217 - sql2api - ERROR - SQL解析异常: type object 'Token' has no attribute 'Text'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.ttype is not Token.Text.Whitespace and operator is not None:
                          ^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Text'
2024-12-24 16:49:46,023 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 16:53:08,504 - sql2api - ERROR - SQL解析失败: type object 'Token' has no attribute 'Text'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.ttype is not Token.Text.Whitespace and operator is not None:
                          ^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Text'
2024-12-24 16:53:08,508 - sql2api - ERROR - SQL解析异常: type object 'Token' has no attribute 'Text'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.ttype is not Token.Text.Whitespace and operator is not None:
                          ^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Text'
2024-12-24 16:54:03,955 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-24 17:04:19,128 - sql2api - ERROR - SQL解析失败: type object 'Token' has no attribute 'Literal'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.is_whitespace is not True and operator is not None:
                      ^^^^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Literal'
2024-12-24 17:04:19,136 - sql2api - ERROR - SQL解析异常: type object 'Token' has no attribute 'Literal'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 208, in _parse_comparison
    if token.is_whitespace is not True and operator is not None:
                      ^^^^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Literal'
2024-12-24 17:04:41,055 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:27:59,880 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:30:59,884 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:32:45,598 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:44:11,701 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:45:42,262 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:55:15,933 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:56:12,570 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 09:56:24,541 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 10:00:17,516 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 10:06:32,216 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 10:19:38,250 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 10:21:05,399 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:21:05,434 - sql2api - ERROR - SQL解析失败: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'column': table_column[1],
              ~~~~~~~~~~~~^^^
IndexError: list index out of range
2024-12-25 10:21:05,436 - sql2api - ERROR - SQL解析异常: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'column': table_column[1],
              ~~~~~~~~~~~~^^^
IndexError: list index out of range
2024-12-25 10:22:06,525 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:22:58,609 - sql2api - ERROR - SQL解析失败: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'column': table_column[1],
              ~~~~~~~~~~~~^^^
IndexError: list index out of range
2024-12-25 10:22:58,614 - sql2api - ERROR - SQL解析异常: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'column': table_column[1],
              ~~~~~~~~~~~~^^^
IndexError: list index out of range
2024-12-25 10:24:15,503 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:24:20,759 - sql2api - ERROR - SQL解析失败: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'leftTable': left_table[0],
          ^^^^^^^^^^^^^^^
IndexError: list index out of range
2024-12-25 10:24:20,764 - sql2api - ERROR - SQL解析异常: list index out of range
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 24, in parse_sql
    where_conditions = self._parse_where_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 190, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 225, in _parse_comparison
    'leftTable': left_table[0],
          ^^^^^^^^^^^^^^^
IndexError: list index out of range
2024-12-25 10:26:08,752 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:33:15,441 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:44:48,324 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:44:48,334 - sql2api - ERROR - SQL解���失败: 'dict' object has no attribute 'table'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info.table
                 ^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'table'
2024-12-25 10:44:48,334 - sql2api - ERROR - SQL解析异常: 'dict' object has no attribute 'table'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info.table
                 ^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'table'
2024-12-25 10:48:35,965 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:48:35,974 - sql2api - ERROR - SQL解���失败: 'dict' object has no attribute 'table'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info.table
                 ^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'table'
2024-12-25 10:48:35,975 - sql2api - ERROR - SQL解析异常: 'dict' object has no attribute 'table'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info.table
                 ^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'table'
2024-12-25 10:55:31,307 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 10:55:31,314 - sql2api - ERROR - SQL解析失败: 'TableInfo' object is not subscriptable
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info['table']
                 ~~~~~~~~~~^^^^^^^^^
TypeError: 'TableInfo' object is not subscriptable
2024-12-25 10:55:31,315 - sql2api - ERROR - SQL解析异常: 'TableInfo' object is not subscriptable
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/sql_parser.py", line 46, in parse_sql
    table_name = table_info['table']
                 ~~~~~~~~~~^^^^^^^^^
TypeError: 'TableInfo' object is not subscriptable
2024-12-25 10:57:42,769 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:00:09,982 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:35:06,853 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:35:07,862 - sql2api - ERROR - SQL解析异常: string indices must be integers, not 'str'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 74, in execute_sql
    params = {
             ^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 75, in <dictcomp>
    cond['column']: cond['value']
    ~~~~^^^^^^^^^^
TypeError: string indices must be integers, not 'str'
2024-12-25 11:41:20,012 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:50:11,829 - sql2api - ERROR - SQL解析异常: string indices must be integers, not 'str'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 74, in execute_sql
    params = parsed_result['request']
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 75, in <dictcomp>
TypeError: string indices must be integers, not 'str'
2024-12-25 11:50:24,006 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:51:21,263 - sql2api - ERROR - SQL解析异常: string indices must be integers, not 'str'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 74, in execute_sql
    params = parsed_result['request']
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 75, in <dictcomp>
TypeError: string indices must be integers, not 'str'
2024-12-25 11:52:00,426 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 11:52:41,799 - sql2api - ERROR - API调用失败: All connection attempts failed
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 26, in call_api_async
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
2024-12-25 11:52:45,833 - sql2api - ERROR - API调用失败: All connection attempts failed
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 26, in call_api_async
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
2024-12-25 11:52:49,871 - sql2api - ERROR - API调用失败: All connection attempts failed
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 26, in call_api_async
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
2024-12-25 12:00:12,713 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x107b4f210 state=finished raised ConnectError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 26, in call_api_async
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x107b4f210 state=finished raised ConnectError>]
2024-12-25 12:00:30,898 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 12:00:48,131 - sql2api - ERROR - API调用失败: All connection attempts failed
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 26, in call_api_async
    response = await client.post(
               ^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
2024-12-25 12:08:43,403 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 12:08:47,468 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 12:08:47,469 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x1073ec190 state=finished raised JSONDecodeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1073ec190 state=finished raised JSONDecodeError>]
2024-12-25 12:11:13,358 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 12:11:14,410 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 12:11:18,468 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 12:11:22,537 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 12:11:22,538 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x113d0d2d0 state=finished raised JSONDecodeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 32, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x113d0d2d0 state=finished raised JSONDecodeError>]
2024-12-25 14:14:59,728 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 14:15:00,447 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:15:04,483 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:15:08,521 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:15:08,522 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x10710cc50 state=finished raised JSONDecodeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x10710cc50 state=finished raised JSONDecodeError>]
2024-12-25 14:18:34,696 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 14:31:24,125 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:31:28,189 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:31:32,230 - sql2api - ERROR - API调用失败: Expecting value: line 1 column 1 (char 0)
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2024-12-25 14:31:32,231 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x10a152e90 state=finished raised JSONDecodeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 42, in call_api_async
    return response.json()
           ^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/httpx/_models.py", line 832, in json
    return jsonlib.loads(self.content, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x10a152e90 state=finished raised JSONDecodeError>]
2024-12-25 14:39:38,937 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 14:40:36,964 - sql2api - ERROR - API调用失败: 'bytes' object has no attribute 'json'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 46, in call_api_async
    return response.content.json()
           ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'json'
2024-12-25 14:50:47,198 - sql2api - ERROR - API调用失败: 'bytes' object has no attribute 'json'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 46, in call_api_async
    # 先进行 UTF-8 解码
          ^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'json'
2024-12-25 14:50:51,241 - sql2api - ERROR - API调用失败: 'bytes' object has no attribute 'json'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 46, in call_api_async
    # 先进行 UTF-8 解码
          ^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'json'
2024-12-25 14:50:51,241 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x108dc6090 state=finished raised AttributeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/services/api_caller.py", line 46, in call_api_async
    # 先进行 UTF-8 解码
          ^^^^^^^^^^^^^^
AttributeError: 'bytes' object has no attribute 'json'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 91, in execute_sql
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/baowu/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x108dc6090 state=finished raised AttributeError>]
2024-12-25 14:51:15,511 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 14:53:17,208 - sql2api - INFO - 所有API调用成功完成
2024-12-25 14:53:25,261 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:06:00,896 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 15:06:25,680 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:06:25,832 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:09:11,056 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 15:15:49,621 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:15:49,758 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:16:36,395 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 15:17:49,647 - sql2api - ERROR - API调用异常: 'dict' object has no attribute 'data'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/src/baowu/sql2apiagent/app/api/endpoints.py", line 97, in execute_sql
    for item in response.data
                ^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'data'
2024-12-25 15:25:19,655 - sql2api - INFO - 收���SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 15:27:05,931 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:27:12,108 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:31:25,879 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 15:40:26,155 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 15:41:29,300 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:41:29,449 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:42:47,067 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001'
2024-12-25 15:49:13,531 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:49:13,654 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:49:25,766 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 15:49:33,499 - sql2api - INFO - 所有API调用成功完成
2024-12-25 15:49:33,610 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 15:54:14,218 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 16:00:39,984 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:00:40,140 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:00:45,778 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 16:01:02,568 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:01:02,671 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:01:22,337 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001'
2024-12-25 16:01:48,074 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:01:57,181 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:20:22,305 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:20:24,150 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:20:24,305 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:21:05,371 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:32:26,818 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:32:26,920 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:32:54,092 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:34:39,211 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:34:39,314 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:34:42,549 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:37:10,444 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:37:10,544 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:37:20,915 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:37:31,323 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:38:38,386 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:38:38,495 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:39:00,864 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:39:00,955 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:44:32,155 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:44:34,027 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:44:34,145 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-25 16:51:29,625 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' limit 0,1
2024-12-25 16:51:31,264 - sql2api - INFO - 所有API调用成功完成
2024-12-25 16:51:31,353 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 10:17:58,026 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 10:18:08,060 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-26 10:18:43,522 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 10:25:02,591 - sql2api - INFO - 所有API调用成功完成
2024-12-26 10:25:02,702 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 10:25:11,504 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 10:25:15,610 - sql2api - INFO - 所有API调用成功完成
2024-12-26 10:25:15,721 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 10:25:34,693 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 11:01:09,313 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' limit 0,1
2024-12-26 11:01:11,135 - sql2api - INFO - 所有API调用成功完成
2024-12-26 11:01:11,263 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 12:04:55,665 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 12:06:39,038 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 12:07:54,985 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 13:40:01,068 - sql2api - ERROR - SQL解析失败: SQLParseResult.__init__() got an unexpected keyword argument 'order_by_conditions'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 40, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() got an unexpected keyword argument 'order_by_conditions'
2024-12-26 14:42:00,972 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 14:42:01,001 - sql2api - ERROR - SQL解析失败: SQLParseResult.__init__() missing 2 required positional arguments: 'join_conditions' and 'order_by_conditions'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 40, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 2 required positional arguments: 'join_conditions' and 'order_by_conditions'
2024-12-26 14:42:01,003 - sql2api - ERROR - SQL解析异常: SQLParseResult.__init__() missing 2 required positional arguments: 'join_conditions' and 'order_by_conditions'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 40, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 2 required positional arguments: 'join_conditions' and 'order_by_conditions'
2024-12-26 14:42:49,473 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 14:43:09,357 - sql2api - INFO - 所有API调用成功完成
2024-12-26 14:43:09,483 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 14:44:03,949 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' propdtgt >= '2024-03-01'
2024-12-26 14:44:03,965 - sql2api - ERROR - SQL解析失败: 'SQLParseResult' object has no attribute 'join_conditions'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 70, in parse_sql
    for join_cond in parse_result.join_conditions:
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SQLParseResult' object has no attribute 'join_conditions'
2024-12-26 14:44:03,966 - sql2api - ERROR - SQL解析异常: 'SQLParseResult' object has no attribute 'join_conditions'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 56, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 70, in parse_sql
    for join_cond in parse_result.join_conditions:
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SQLParseResult' object has no attribute 'join_conditions'
2024-12-26 14:46:03,023 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' propdtgt >= '2024-03-01'
2024-12-26 14:56:53,753 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:10:10,474 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:10:56,889 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:11:35,142 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:17:33,206 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:22:15,050 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:22:49,062 - sql2api - INFO - 所有API调用成功完成
2024-12-26 15:22:49,186 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 15:23:15,895 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:25:16,181 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:26:26,602 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:27:18,067 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:27:33,021 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:27:34,889 - sql2api - INFO - 所有API调用成功完成
2024-12-26 15:27:35,000 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 15:33:21,601 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QFLT.devicename >= '2024-03-01'
2024-12-26 15:39:42,402 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QPC.propdtgt >= '2024-03-01'
2024-12-26 15:39:52,647 - sql2api - INFO - 所有API调用成功完成
2024-12-26 15:39:52,751 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 15:57:35,682 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.devicename IS NOT NULL and QFLT.devicename = 'DM001' and QPC.propdtgt >= '2024-03-01'
2024-12-26 16:34:59,444 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 16:35:01,307 - sql2api - INFO - 所有API调用成功完成
2024-12-26 16:35:01,429 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-26 16:51:54,593 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 16:55:54,511 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 16:57:14,243 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 16:57:24,264 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-26 16:57:56,271 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-26 16:57:59,208 - sql2api - INFO - 所有API调用成功完成
2024-12-26 16:57:59,327 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 09:36:55,881 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-27 09:36:57,568 - sql2api - INFO - 所有API调用成功完成
2024-12-27 09:36:57,700 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 11:21:28,117 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-27 11:21:38,159 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-27 11:27:38,191 - sql2api - INFO - 收到SQL执行请求: SELECT opname, devtypename, dmtpc, abnphen, devicename, devicecode FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QPC WHERE devicename = 'DM001' and propdtgt >= '2024-03-01' order by propdtgt desc limit 2
2024-12-27 11:27:40,731 - sql2api - INFO - 所有API调用成功完成
2024-12-27 11:27:40,995 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 15:46:52,275 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 15:46:54,475 - sql2api - INFO - 所有API调用成功完成
2024-12-27 15:46:54,649 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 15:53:15,105 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 15:53:17,504 - sql2api - INFO - 所有API调用成功完成
2024-12-27 15:53:17,663 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 15:55:31,868 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%机器%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 15:55:33,191 - sql2api - INFO - 所有API调用成功完成
2024-12-27 15:55:33,316 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 15:56:04,900 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%机器%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 16:40:53,719 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%机器%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 16:40:55,949 - sql2api - ERROR - SQL解析异常: 'dict' object has no attribute 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 64, in merge_results
    if parsed_results.order_by:
       ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'order_by'
2024-12-27 16:43:33,721 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%机器%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 16:43:35,940 - sql2api - INFO - 所有API调用成功完成
2024-12-27 16:43:36,068 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-27 16:44:09,123 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%设备12%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-27 16:44:09,303 - sql2api - INFO - 所有API调用成功完成
2024-12-27 16:44:09,485 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 11:46:44,926 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 11:46:53,979 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x124145f90 state=finished raised TypeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: APICaller.call_api_async() missing 1 required positional argument: 'limit_dict'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 53, in execute_api_calls
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x124145f90 state=finished raised TypeError>]
2024-12-30 11:50:33,630 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 11:51:07,229 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x106cd4510 state=finished raised TypeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: APICaller.call_api_async() missing 1 required positional argument: 'limit_dict'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 53, in execute_api_calls
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x106cd4510 state=finished raised TypeError>]
2024-12-30 11:52:38,566 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:24:51,671 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:27:53,787 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x10523d7d0 state=finished raised TypeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: APICaller.call_api_async() missing 1 required positional argument: 'limit_dict'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 53, in execute_api_calls
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x10523d7d0 state=finished raised TypeError>]
2024-12-30 13:28:15,266 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltlvc` IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:31:19,456 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:33:23,711 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:34:04,831 - sql2api - ERROR - SQL解析失败: unsupported operand type(s) for |: 'bool' and '_TokenType'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 32, in parse_sql
    conditions = self._parse_where_conditions(parsed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 243, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 294, in _parse_comparison
    if isinstance(token, Identifier) | token.ttype is Token.Name:
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for |: 'bool' and '_TokenType'
2024-12-30 13:36:35,089 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:36:52,634 - sql2api - ERROR - SQL解析失败: unsupported operand type(s) for |: 'bool' and '_TokenType'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 32, in parse_sql
    conditions = self._parse_where_conditions(parsed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 243, in _parse_where_conditions
    condition = self._parse_comparison(item)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 294, in _parse_comparison
    if isinstance(token, Identifier) | token.ttype == Token.Name:
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for |: 'bool' and '_TokenType'
2024-12-30 13:37:58,739 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:41:33,628 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:43:37,202 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 13:45:11,734 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:06:28,283 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:19:36,291 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:19:36,308 - sql2api - ERROR - SQL解析失败: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 32, in parse_sql
    conditions = self._parse_where_conditions(parsed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 246, in _parse_where_conditions
    elif isinstance(item, Keyword):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2024-12-30 14:19:36,309 - sql2api - ERROR - SQL解析异常: isinstance() arg 2 must be a type, a tuple of types, or a union
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 57, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 32, in parse_sql
    conditions = self._parse_where_conditions(parsed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 246, in _parse_where_conditions
    elif isinstance(item, Keyword):
         ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: isinstance() arg 2 must be a type, a tuple of types, or a union
2024-12-30 14:21:01,467 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:22:31,913 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:38:24,383 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:40:18,754 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:40:34,989 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x106c02550 state=finished raised TypeError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^
TypeError: APICaller.call_api_async() missing 1 required positional argument: 'limit_dict'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 53, in execute_api_calls
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x106c02550 state=finished raised TypeError>]
2024-12-30 14:48:22,640 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:50:45,994 - sql2api - INFO - 所有API调用成功完成
2024-12-30 14:50:46,149 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 14:52:51,447 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 14:56:13,468 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:00:05,120 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:00:24,490 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:00:33,657 - sql2api - INFO - 所有API调用成功完成
2024-12-30 15:00:34,877 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 15:04:17,879 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:08:06,158 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:14:04,554 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:15:25,246 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:15:52,075 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:15:55,681 - sql2api - INFO - 所有API调用成功完成
2024-12-30 15:15:55,817 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 15:17:42,230 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:23:19,028 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:43:49,377 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 15:52:26,237 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 16:01:35,533 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 16:12:59,214 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 16:13:07,316 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:13:07,454 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 16:16:20,868 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 16:16:23,029 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:23,034 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:27,210 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:27,211 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:31,378 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:31,379 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2024-12-30 16:16:31,379 - sql2api - ERROR - API调用异常: RetryError[<Future at 0x1069005d0 state=finished raised HTTPStatusError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 39, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 53, in execute_api_calls
    api_responses = await asyncio.gather(*tasks)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x1069005d0 state=finished raised HTTPStatusError>]
2024-12-30 16:20:20,577 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01' AND fltlvc IN ('A','B');
2024-12-30 16:20:20,918 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:20:21,052 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 16:21:56,862 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01'
2024-12-30 16:21:56,940 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:21:57,103 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 16:23:18,841 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01'
2024-12-30 16:46:47,485 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltlvc IN ('A','B') AND `fltstgt` > '2024-06-01';
2024-12-30 16:46:50,732 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:46:50,881 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 16:47:40,918 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltstgt` > '2024-06-01';
2024-12-30 16:47:41,786 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:47:42,607 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 16:50:59,833 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE devicename > '设备6';
2024-12-30 16:51:01,100 - sql2api - INFO - 所有API调用成功完成
2024-12-30 16:51:01,204 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-30 17:02:19,359 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE basecode = 'ABC' AND devicename LIKE '%设备12%' AND fltlvc = 'A' AND ldlt > 10;
2024-12-30 17:02:20,594 - sql2api - INFO - 所有API调用成功完成
2024-12-30 17:02:20,731 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 09:36:13,672 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2;
2024-12-31 09:36:13,691 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2006, "MySQL server has gone away (BrokenPipeError(32, 'Broken pipe'))")
[SQL: SELECT api_mappings.id AS api_mappings_id, api_mappings.table_name AS api_mappings_table_name, api_mappings.api_url AS api_mappings_api_url, api_mappings.method AS api_mappings_method, api_mappings.request_template AS api_mappings_request_template 
FROM api_mappings 
WHERE api_mappings.table_name = %(table_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'table_name_1': 'D_A_BSPDDC00_QFLT', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-31 09:38:20,546 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2;
2024-12-31 09:38:22,832 - sql2api - INFO - 所有API调用成功完成
2024-12-31 09:38:23,021 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 09:43:27,709 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME desc;
2024-12-31 09:43:27,934 - sql2api - INFO - 所有API调用成功完成
2024-12-31 09:43:28,081 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 09:43:30,592 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME desc;
2024-12-31 09:43:30,824 - sql2api - INFO - 所有API调用成功完成
2024-12-31 09:43:30,956 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 09:45:22,571 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME desc;
2024-12-31 10:00:20,136 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME desc;
2024-12-31 10:00:22,430 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:00:22,596 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:00:34,406 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME;
2024-12-31 10:00:34,669 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:00:35,104 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:01:34,351 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:01:34,553 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:01:34,710 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:06:35,116 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:06:37,347 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:06:37,508 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:07:53,942 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:10:30,032 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:14:06,632 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:16:50,475 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:18:55,741 - sql2api - ERROR - SQL解析失败: type object 'Token' has no attribute 'Literal'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 32, in parse_sql
    conditions = self._parse_where_conditions(parsed)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 252, in _parse_where_conditions
    limit_conditions = self._parse_limit_conditions(parsed)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 271, in _parse_limit_conditions
    if token.ttype is Token.Literal.Number.Integer:
                      ^^^^^^^^^^^^^
AttributeError: type object 'Token' has no attribute 'Literal'
2024-12-31 10:20:07,597 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:22:20,106 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:22:26,883 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:22:27,042 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:22:55,465 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:25:46,422 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:43:49,814 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:45:00,981 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:45:11,002 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-31 10:45:33,451 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:45:43,471 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-31 10:48:50,492 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 10:48:53,575 - sql2api - INFO - 所有API调用成功完成
2024-12-31 10:48:53,743 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 10:55:48,347 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 11:16:51,444 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 11:18:34,569 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 11:18:35,739 - sql2api - INFO - 所有API调用成功完成
2024-12-31 11:18:35,890 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 13:55:12,716 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE, QDIAG.CONCLUSION, QDIAG.CRITERIA FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename LEFT JOIN D_A_BSPDDC00_QDIAG QDIAG ON QFLT.devicename = QDIAG.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 14:15:36,865 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2024-12-31 14:15:40,386 - sql2api - INFO - 所有API调用成功完成
2024-12-31 14:15:40,523 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 15:31:38,482 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:31:38,492 - sql2api - ERROR - 多表查询执行失败: 'JoinCondition' object is not subscriptable
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 92, in _execute_multi_table_query
    first_join = next((join for join in parsed_joins if join['sequence'] == 1), None)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 92, in <genexpr>
    first_join = next((join for join in parsed_joins if join['sequence'] == 1), None)
                                                        ~~~~^^^^^^^^^^^^
TypeError: 'JoinCondition' object is not subscriptable
2024-12-31 15:35:34,900 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:37:07,778 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:38:07,696 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:46:04,785 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:53:44,355 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:54:16,189 - sql2api - ERROR - 多表查询执行失败: 'JoinCondition' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 108, in _execute_multi_table_query
    for join in sorted(parsed_joins, key=lambda x: x.get('sequence', 0)):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 108, in <lambda>
    for join in sorted(parsed_joins, key=lambda x: x.get('sequence', 0)):
                                                   ^^^^^
AttributeError: 'JoinCondition' object has no attribute 'get'
2024-12-31 15:54:53,268 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 15:55:32,751 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 16:01:09,046 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 16:17:01,329 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 16:23:06,287 - sql2api - INFO - 所有API调用成功完成
2024-12-31 16:23:06,421 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2024-12-31 16:26:13,969 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 10;
2024-12-31 17:00:24,074 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2024-12-31 17:01:03,171 - sql2api - ERROR - 多表查询执行失败: list indices must be integers or slices, not str
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 133, in _execute_multi_table_query
    right_table_info['request'][right_column] = item[left_column]
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: list indices must be integers or slices, not str
2024-12-31 17:02:10,453 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2024-12-31 17:04:00,293 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2024-12-31 17:05:06,674 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2024-12-31 17:05:19,290 - sql2api - ERROR - 多表查询执行失败: 'dict' object has no attribute 'append'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 133, in _execute_multi_table_query
    right_table_info['request'][0].append({right_column: item[left_column]})
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'append'
2024-12-31 17:05:56,741 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2024-12-31 17:11:27,859 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.FAULTLEVELNAME,QFLT.FAULTSPECIALTYNAME, QPC.opname, QPC.propdtgt, QPC.ABNPHENOMENON, QPC.RECSOURCE FROM D_A_BSPDDC00_QFLT QFLT LEFT JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.fltlvn = '三级故障' and QPC.propdtgt > '2024-04-01' limit 3;
2025-01-02 10:00:56,768 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' order by fltstgt desc limit 2;
2025-01-02 10:01:00,948 - sql2api - INFO - 所有API调用成功完成
2025-01-02 10:01:01,137 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 10:05:18,882 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' order by fltstgt desc limit 2;
2025-01-02 10:27:07,987 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' order by fltstgt desc limit 2;
2025-01-02 10:38:32,564 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 10:44:27,684 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 10:45:55,851 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 10:47:55,001 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 10:48:04,792 - sql2api - ERROR - SQL解析异常: 'WhereCondition' object is not subscriptable
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 101, in merge_results
    merged_data = MergeService.sort_results(merged_data, parsed_results['order_by'])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 171, in sort_results
    return sorted(data, key=get_sort_key)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 146, in get_sort_key
    column = sort_condition['column']
             ~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: 'WhereCondition' object is not subscriptable
2025-01-02 10:49:12,683 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 10:57:11,487 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:00:56,627 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:18:20,039 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:18:20,059 - sql2api - ERROR - SQL解析失败: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:18:20,060 - sql2api - ERROR - SQL解析异常: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 57, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:20:25,226 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:20:25,244 - sql2api - ERROR - SQL解析失败: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:20:25,245 - sql2api - ERROR - SQL解析异常: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 57, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:20:27,988 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:20:27,995 - sql2api - ERROR - SQL解析失败: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:20:27,995 - sql2api - ERROR - SQL解析异常: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 57, in execute_sql
    parsed_results = parser.parse_sql(request.sql)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/sql_parser.py", line 37, in parse_sql
    parse_result = SQLParseResult(
                   ^^^^^^^^^^^^^^^
TypeError: SQLParseResult.__init__() missing 1 required positional argument: 'order_by'
2025-01-02 11:23:17,702 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:23:19,179 - sql2api - ERROR - SQL解析异常: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 100, in merge_results
    if parsed_results['order_by']:
       ~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'order_by'
2025-01-02 11:25:53,890 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:27:16,707 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:30:38,980 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:33:28,889 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:34:40,054 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:34:41,899 - sql2api - ERROR - SQL解析异常: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 100, in merge_results
    if parsed_results['order_by']:
       ~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'order_by'
2025-01-02 11:45:58,694 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:46:00,570 - sql2api - ERROR - SQL解析异常: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 100, in merge_results
    if parsed_results['order_by']:
       ~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'order_by'
2025-01-02 11:48:02,391 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:48:04,287 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 11:48:08,453 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 11:48:12,618 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 11:48:12,619 - sql2api - ERROR - 单表查询执行失败: RetryError[<Future at 0x109bb9bd0 state=finished raised HTTPStatusError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QFLT'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 59, in _execute_single_table_query
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x109bb9bd0 state=finished raised HTTPStatusError>]
2025-01-02 11:49:22,678 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:49:24,491 - sql2api - ERROR - SQL解析异常: 'order_by'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 100, in merge_results
    if parsed_results['order_by']:
       ~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'order_by'
2025-01-02 11:58:31,764 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:58:33,593 - sql2api - ERROR - SQL解析异常: 'WhereCondition' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 101, in merge_results
    merged_data = MergeService.sort_results(merged_data, parsed_results['where_conditions'])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 144, in sort_results
    order_by = [
               ^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 146, in <listcomp>
    if condition.get('operator', '').upper() == 'ORDER BY'
       ^^^^^^^^^^^^^
AttributeError: 'WhereCondition' object has no attribute 'get'
2025-01-02 11:59:42,694 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 11:59:44,694 - sql2api - INFO - 所有API调用成功完成
2025-01-02 11:59:44,816 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 12:02:09,075 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 12:08:27,843 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 12:09:57,512 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 12:10:26,356 - sql2api - ERROR - SQL解析异常: 'WhereCondition' object is not subscriptable
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 101, in merge_results
    merged_data = MergeService.sort_results(merged_data, parsed_results['where_conditions'])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 181, in sort_results
    return sorted(data, key=get_sort_key)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 156, in get_sort_key
    column = sort_condition['column']
             ~~~~~~~~~~~~~~^^^^^^^^^^
TypeError: 'WhereCondition' object is not subscriptable
2025-01-02 12:12:02,967 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 12:14:21,729 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:33:11,910 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:33:21,941 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on '172.20.7.75' (timed out)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-01-02 13:33:59,591 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:34:29,972 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:34:30,907 - sql2api - INFO - 所有API调用成功完成
2025-01-02 13:34:31,016 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 13:39:01,754 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:39:03,456 - sql2api - ERROR - SQL解析异常: bad operand type for unary -: 'datetime.datetime'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/api/endpoints.py", line 73, in execute_sql
    final_result = await merge_service.merge_results(all_results, parsed_results)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 101, in merge_results
    merged_data = MergeService.sort_results(merged_data, parsed_results['where_conditions'])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 181, in sort_results
    return sorted(data, key=get_sort_key)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/merge_service.py", line 175, in get_sort_key
    value = -value
            ^^^^^^
TypeError: bad operand type for unary -: 'datetime.datetime'
2025-01-02 13:41:40,906 - sql2api - INFO - 收到SQL执行请求: SELECT * FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE `fltspn` like '%电气%' AND `fltstgt` > '2022-01-01' AND devicename in ('设备1','设备19') order by fltstgt desc limit 2;
2025-01-02 13:41:42,681 - sql2api - INFO - 所有API调用成功完成
2025-01-02 13:41:42,789 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 14:04:36,969 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2025-01-02 14:05:01,959 - sql2api - ERROR - 获取API映射失败: (pymysql.err.OperationalError) (2013, 'Lost connection to MySQL server during query ([Errno 60] Operation timed out)')
[SQL: SELECT api_mappings.id AS api_mappings_id, api_mappings.table_name AS api_mappings_table_name, api_mappings.api_url AS api_mappings_api_url, api_mappings.method AS api_mappings_method, api_mappings.request_template AS api_mappings_request_template 
FROM api_mappings 
WHERE api_mappings.table_name = %(table_name_1)s 
 LIMIT %(param_1)s]
[parameters: {'table_name_1': 'D_A_BSPDDC00_QFLT', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-01-02 14:05:45,340 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2025-01-02 14:05:47,469 - sql2api - INFO - 所有API调用成功完成
2025-01-02 14:05:47,572 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 14:08:46,813 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2025-01-02 14:08:48,608 - sql2api - INFO - 所有API调用成功完成
2025-01-02 14:08:48,711 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 14:11:19,863 - sql2api - INFO - 收到SQL执行请求: SELECT basecode, devicename , FAULTLEVELNAME , FAULTSPECIALTYNAME  FROM data_agent_sql2api_tbl.D_A_BSPDDC00_QFLT WHERE fltdrlt < 4 and fltdrgt > 2 order by FAULTLEVELNAME limit 2;
2025-01-02 14:11:21,686 - sql2api - INFO - 所有API调用成功完成
2025-01-02 14:11:21,785 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
2025-01-02 14:23:12,185 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:30:57,262 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:35:25,629 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:35:35,101 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 14:35:39,314 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 14:35:43,471 - sql2api - ERROR - API调用失败: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-01-02 14:35:43,472 - sql2api - ERROR - 单表查询执行失败: RetryError[<Future at 0x105933010 state=finished raised HTTPStatusError>]
Traceback (most recent call last):
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_caller.py", line 38, in call_api_async
    response.raise_for_status()
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Server error '500 ' for url 'http://localhost:8080/service/D_A_BSPDDC00_QPC'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 61, in _execute_single_table_query
    response = await self.api_caller.call_api_async(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lifenghua/.conda/envs/nl2api/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x105933010 state=finished raised HTTPStatusError>]
2025-01-02 14:36:49,419 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:37:47,266 - sql2api - ERROR - 多表查询执行失败: 'QPC'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 103, in _execute_multi_table_query
    right_data = table_results[join.rightTable]
                 ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
KeyError: 'QPC'
2025-01-02 14:39:42,170 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:39:59,950 - sql2api - ERROR - 多表查询执行失败: 'D_A_BSPDDC00_QFLT'
Traceback (most recent call last):
  File "/Users/lifenghua/Documents/work/zetyun/git/baowu/sql2api-agent/app/services/api_service.py", line 99, in _execute_multi_table_query
    merged_results = table_results[parsed_tables[0]['table']]  # 从第一个表开始
                     ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'D_A_BSPDDC00_QFLT'
2025-01-02 14:40:30,259 - sql2api - INFO - 收到SQL执行请求: SELECT QFLT.basecode,QFLT.devicename,QFLT.fltlvc,QFLT.fltlvn,QFLT.fltspc,QFLT.fltspn,QFLT.fltstgt,QFLT.fltdrlt,QFLT.fltdrgt,QFLT.ldlt,QPC.opname AS qpc_opname,QPC.devicename AS qpc_devicename,QPC.propdtgt FROM D_A_BSPDDC00_QFLT QFLT INNER JOIN D_A_BSPDDC00_QPC QPC ON QFLT.devicename = QPC.devicename WHERE QFLT.basecode  = 'ABC' and QPC.propdtgt >= '2024-03-01';
2025-01-02 14:44:01,337 - sql2api - INFO - 所有API调用成功完成
2025-01-02 14:44:01,438 - sql2api - ERROR - Redis设置缓存失败: Invalid input of type: 'list'. Convert to a bytes, string, int or float first.
